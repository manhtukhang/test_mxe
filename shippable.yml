# Author: Khang Mạnh Tử
build_environment: ubuntu1204

#compiler:
  #- gcc
  # - clang

before_install:
  - sudo add-apt-repository ppa:ubuntu-toolchain-r/test -y
  - sudo apt-get update -qq
  # - sudo apt-get upgrade -y
  - sudo apt-get install g++-4.8 g++-4.8-multilib autopoint intltool unzip g++-multilib libc6-dev-i386 gperf tree -y
  - sudo update-alternatives --install /usr/bin/gcc gcc /usr/bin/gcc-4.8 50
  - sudo update-alternatives --install /usr/bin/g++ g++ /usr/bin/g++-4.8 50

before_script:
  - git clone --branch=master https://github.com/mxe/mxe.git $HOME/mxe
  - MINS=45
  - NUM_JOBS=$((2 * $(grep processor /proc/cpuinfo | wc -l) / 2))
  - echo $NUM_JOBS

script:
  - cd $HOME/mxe
  - while [ $MINS -gt 0 ]; do echo -e "\n$MINS\033[0K\r\n"; sleep 60; MINS=$((MINS-1)); done & make qt5 flex bison --jobs=$NUM_JOBS

after_success:
  - tree > tree.txt
  - cat tree.txt

branches:
  only:
    - shipable
